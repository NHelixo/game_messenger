{% extends 'base.html' %}

{% block title %}–ì–æ–ª–æ–≤–Ω–∞{% endblock %}

{% block content %}
    <div class="max-w-4xl mx-auto p-4">

        <!-- –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –ø–æ—à—É–∫ -->
        <div class="flex justify-between mb-6">
            <a href="{% url 'friend_feed:search_friend' %}" class="px-4 py-2 text-white bg-blue-500 rounded-md hover:bg-blue-600 transition-colors">–ó–Ω–∞–π—Ç–∏ –¥—Ä—É–≥–∞</a>
            <a href="{% url 'friend_feed:search_community' %}" class="px-4 py-2 text-white bg-gray-500 rounded-md hover:bg-gray-600 transition-colors">–ó–Ω–∞–π—Ç–∏ —Å–ø—ñ–ª—å–Ω–æ—Ç—É</a>
        </div>

        <!-- –ü–æ—Å—Ç–∏ -->
        {% if posts %}
            {% for post in posts %}
                <div class="bg-white rounded-lg shadow-md mb-6 p-4 flex gap-4">
                    <!-- –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é -->
                    <div class="w-28 h-28 overflow-hidden rounded-full border-2 border-gray-300">
                        <img src="{% if post.profile.profile_picture %}{{ post.profile.profile_picture.url }}{% else %}/media/profile_pictures/default.jpg{% endif %}" alt="Profile Picture" class="w-full h-full object-cover">
                    </div>

                    <div class="flex-1">
                        <h2 class="text-xl font-semibold text-gray-800">{{ post.user }}</h2>
                        <p class="text-gray-600 mt-2">{{ post.text }}</p>

                        <div class="flex gap-4 mt-4">
                            <!-- –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ—Å—Ç—É (–ª—ñ–≤–æ—Ä—É—á) -->
                            {% if post.image %}
                                <div class="flex-1">
                                    <img src="{{ post.image.url }}" alt="{{ post.title }}" class="max-w-full h-auto rounded-lg shadow-sm">
                                </div>
                            {% endif %}

                            <!-- –í—ñ–¥–µ–æ (–ø—Ä–∞–≤–æ—Ä—É—á) -->
                            {% if post.video %}
                                <div class="flex-1">
                                    <video controls class="max-w-full h-auto rounded-lg shadow-sm">
                                        <source src="{{ post.video.url }}" type="video/mp4">
                                        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î –≤—ñ–¥–µ–æ.
                                    </video>
                                </div>
                            {% endif %}
                        </div>

                        <!-- –õ–∞–π–∫–∏ —Ç–∞ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ -->
                        <div class="mt-4 flex items-center gap-6">
                            <form method="post" action="{% url 'friend_feed:toggle_like' post.id %}">
                                {% csrf_token %}
                                <button type="submit" class="px-4 py-2 text-sm bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors">üëç {{ post.like_count }}</button>
                            </form>

                            <form method="post" action="{% url 'friend_feed:add_comment' post.id %}" class="flex-1">
                                {% csrf_token %}
                                <textarea name="comment_text" placeholder="–í–∞—à –∫–æ–º–µ–Ω—Ç–∞—Ä..." class="w-full p-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                                <button type="submit" class="mt-2 w-full py-2 text-white bg-yellow-500 rounded-md hover:bg-yellow-600 transition-colors">–î–æ–¥–∞—Ç–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä</button>
                            </form>
                        </div>

                        <!-- –ß–∞—Å –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó -->
                        <p class="text-xs text-gray-500 mt-2">{{ post.create_time }}</p>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <div class="text-center">
                {% if user.is_authenticated %}
                    <h2 class="text-xl text-gray-700">–ù–µ–º–∞—î –ø–æ—Å—Ç—ñ–≤!</h2>
                {% else %}
                    <h2 class="text-xl text-gray-700">–£–≤—ñ–π–¥—ñ—Ç—å –∞–±–æ –∑–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—å, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç —Å–≤–æ—ó—Ö –¥—Ä—É–∑—ñ–≤!</h2>
                {% endif %}
            </div>
        {% endif %}
    </div>
{% endblock %}
